# Документация для класса LFUCache

## Обзор

`LFUCache` - это шаблонный класс, реализующий кэш с политикой вытеснения **Least Frequently Used (LFU)**. Наследуется от базового класса `BaseCache` и обеспечивает эффективное хранение и доступ к элементам с автоматическим удалением наименее используемых элементов при заполнении кэша.

## Структура класса

### Шаблонные параметры
- `Tkey` - тип ключа для доступа к элементам
- `Tvalue` - тип хранимых значений

### Внутренние структуры данных

#### Структура KaC
```cpp
struct KaC {
    Tkey key;           // Ключ элемента
    size_t using_count; // Счетчик использования
};
```

#### Основные поля
- `std::list<KaC> lfu_list` - двусвязный список для хранения пар (ключ, счетчик использования)
- `std::unordered_map<Tkey, typename std::list<KaC>::iterator> key_iter` - хэш-таблица для быстрого доступа к итераторам списка по ключу
- `size_t capacity` - максимальная вместимость кэша

## Методы

### Конструктор
```cpp
LFUCache(size_t capacity)
```
**Параметры:**
- `capacity` - максимальное количество элементов в кэше

**Исключения:**
- `std::runtime_error` - если capacity равен 0

### put
```cpp
void put(const Tkey& key, const Tvalue& item)
```
Добавляет элемент в кэш или обновляет существующий.

**Алгоритм:**
1. Если кэш заполнен, удаляется элемент с наименьшим счетчиком использования
2. Для нового элемента создается запись в списке с счетчиком = 1
3. Для существующего элемента увеличивается счетчик и производится пересортировка списка
4. Элемент добавляется в основное хранилище

**Параметры:**
- `key` - ключ элемента
- `item` - значение элемента

### get
```cpp
Tvalue& get(const Tkey& key)
```
Получает элемент по ключу и увеличивает его счетчик использования.

**Алгоритм:**
1. Поиск элемента в хранилище
2. Увеличение счетчика использования
3. Пересортировка списка для поддержания порядка по частоте использования

**Параметры:**
- `key` - ключ элемента

**Возвращает:**
- Ссылку на значение элемента

**Исключения:**
- `std::runtime_error` - если ключ не найден

### erase
```cpp
void erase(const Tkey& key)
```
Удаляет элемент из кэша по ключу.

**Параметры:**
- `key` - ключ элемента для удаления

**Исключения:**
- `std::runtime_error` - если ключ не найден

## Особенности реализации

### Алгоритм LFU
- Элементы отсортированы по частоте использования (в порядке возрастания)
- При переполнении удаляется последний элемент списка (наименее используемый)
- При каждом обращении к элементу его счетчик увеличивается и производится перестановка в списке

### Сложность операций
- **put**: O(n) в худшем случае (из-за необходимости перестановки в списке)
- **get**: O(n) в худшем случае (аналогично put)
- **erase**: O(1) в среднем случае

### Требования к типам
- `Tkey` должен поддерживать хэширование (для использования в unordered_map)
- `Tkey` должен поддерживать операцию сравнения
- `Tvalue` должен иметь конструктор по умолчанию и конструктор копирования

## Пример использования

```cpp
LFUCache<int, std::string> cache(3);

cache.put(1, "one");
cache.put(2, "two");
cache.put(3, "three");

std::string value = cache.get(1); // Увеличит счетчик для ключа 1
cache.put(4, "four"); // Вытеснит элемент с ключом 2 (наименее используемый)
```