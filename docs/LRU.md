# Документация для класса LRUCache

## Обзор

`LRUCache` - это шаблонный класс, реализующий кэш с политикой вытеснения **Least Recently Used (LRU)**. Наследуется от базового класса `BaseCache` и обеспечивает эффективное хранение и доступ к элементам с автоматическим удалением наименее недавно использованных элементов при заполнении кэша.

## Структура класса

### Шаблонные параметры
- `Tkey` - тип ключа для доступа к элементам
- `Tvalue` - тип хранимых значений

### Основные поля
- `size_t capacity` - максимальная вместимость кэша
- `std::unordered_map<Tkey, typename std::list<Tkey>::iterator> key_iter` - хэш-таблица для быстрого доступа к итераторам списка по ключу
- `std::list<Tkey> lru_list` - двусвязный список для отслеживания порядка использования ключей (от наиболее к наименее recent)

## Методы

### Конструктор
```cpp
LRUCache(size_t capacity)
```
**Параметры:**
- `capacity` - максимальное количество элементов в кэше

**Исключения:**
- `std::runtime_error` - если capacity равен 0

### put
```cpp
void put(const Tkey& key, const Tvalue& item)
```
Добавляет элемент в кэш или обновляет существующий.

**Алгоритм:**
1. Если элемент с таким ключом уже существует, удаляет его из списка LRU
2. Если кэш заполнен, удаляет наименее недавно использованный элемент (конец списка)
3. Добавляет ключ в начало списка LRU
4. Обновляет итератор в хэш-таблице
5. Сохраняет значение в основном хранилище

**Параметры:**
- `key` - ключ элемента
- `item` - значение элемента

### get
```cpp
Tvalue& get(const Tkey& key)
```
Получает элемент по ключу и помечает его как недавно использованный.

**Алгоритм:**
1. Поиск элемента в хранилище
2. Удаление ключа из текущей позиции в списке LRU
3. Добавление ключа в начало списка LRU
4. Обновление итератора в хэш-таблице
5. Возврат значения элемента

**Параметры:**
- `key` - ключ элемента

**Возвращает:**
- Ссылку на значение элемента

**Исключения:**
- `std::runtime_error` - если ключ не найден

### erase
```cpp
void erase(const Tkey& key)
```
Удаляет элемент из кэша по ключу.

**Алгоритм:**
1. Удаление элемента из основного хранилища
2. Удаление ключа из списка LRU
3. Удаление записи из хэш-таблицы итераторов

**Параметры:**
- `key` - ключ элемента для удаления

**Исключения:**
- `std::runtime_error` - если ключ не найден

## Особенности реализации

### Алгоритм LRU
- Элементы отсортированы по времени последнего использования
- Начало списка (`front`) содержит наиболее недавно использованные элементы
- Конец списка (`back`) содержит наименее недавно использованные элементы
- При каждом обращении к элементу он перемещается в начало списка
- При переполнении удаляется последний элемент списка

### Ключевые особенности
- Использование `typename` для указания, что `std::list<Tkey>::iterator` является типом
- Комбинация хэш-таблицы и двусвязного списка для эффективной работы
- Поддержание согласованности между хранилищем, списком LRU и хэш-таблицей итераторов

### Сложность операций
- **put**: O(1) в среднем случае
- **get**: O(1) в среднем случае  
- **erase**: O(1) в среднем случае

### Требования к типам
- `Tkey` должен поддерживать хэширование (для использования в unordered_map)
- `Tkey` должен поддерживать операцию сравнения
- `Tvalue` должен иметь конструктор по умолчанию и конструктор копирования

## Пример использования

```cpp
LRUCache<int, std::string> cache(3);

cache.put(1, "one");
cache.put(2, "two"); 
cache.put(3, "three");

std::string value = cache.get(1); // Переместит ключ 1 в начало списка
cache.put(4, "four"); // Вытеснит элемент с ключом 2 (наименее недавно использованный)
```

## Примечания

Класс демонстрирует эффективную реализацию алгоритма LRU с постоянным временем выполнения основных операций благодаря комбинации структур данных:
- `std::unordered_map` для быстрого доступа по ключу
- `std::list` для эффективного перемещения элементов и удаления с концов